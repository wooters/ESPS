# NAME

mergefea - merge two FEA files so that output records contain fields
from both

# SYNOPSIS

**mergefea** \[ **-f** *field_name* \] . . . \[ **-t** \] \[ **-u** \]
\[ **-a** \] \[ **-x** *debug_level* \] \[ **-z** \] \[ **-T**
*FEA_subtype* \] *fea1 fea2* \[ *fea3* \]

# DESCRIPTION

If *fea1* and *fea2* both exist, *mergefea* merges their records in the
sense that the fields in each output record comprise the union of fields
in two input records. The results of the merge can be written to a third
file *fea3*, or *fea2* can be rewritten to contain the merged results
(think of this as merging *fea1* into *fea2*). The **-f** option can be
used to restrict which fields are taken from the *fea1* records. If
*fea2* doesn't exist, it is created and contains only the selected
fields from *fea1* (thus, *mergefea* can be used to filter fields out of
FEA files).

If both input files exist, then each record of the output contains all
of the fields from the corresponding *fea2* record and the selected
fields from the corresponding *fea1* record (all of them unless the
**-f** option is used). None of the selected fields from *fea1* may have
the same name as a field in *fea2*. The size of the output file is
determined by the size of *fea2* - they have the same number of records.
If *fea1* has more records than *fea2*, then the additional records are
ignored. If *fea1* has fewer records than *fea2*, then the field values
in the last record of *fea1* are duplicated for merging with the
additional *fea2* records. If *fea3* is supplied, then the output is
written to *fea3*, and the original contents of *fea2* are left
unchanged. If *fea3* is not supplied, then the contents of the output
file replace the previous contents of *fea2*. That is, *mergefea*
rewrites *fea2* with additional fields in each record.

If *fea2* does not exist, it is created as an output file, and *fea3*
must not be supplied.

Generic header items are copied from input to output. If *fea1* and
*fea2* contain header items with the same name, the value in *fea2*
prevails. This behavior can be changed by using the **-u** option, which
causes all generics from *fea1* to be copied; unique new names are
generated if generics by the same name already exist in *fea2*).

If *fea1* is "-", standard input is used. If *fea3* is not supplied and
*fea2* is "-", standard output is used (in this case, *mergefea* is just
a field filter). If *fea3* is supplied and *fea2* is "-", standard input
is used, but *fea1* and *fea2* may not both be standard input. If *fea3*
is "-", standard output is used.

# OPTIONS

The following options are supported:

**-f** *field_name*  
Specifies a field name to be taken from *fea1*. If no **-f** option is
given, all fields are taken. This option may be given more than once.

**-t**  
This option makes the output file a tagged file and causes record *tag*
values to be copied from *fea1* to the output file, along with the
specified feature fields. If the option is not specified, then the
output file is tagged if and only if *fea2* exists and is tagged, and
the *tag* values, if any, are copied from *fea2*.

**-u**  
If generic header items in *fea1* have names that exist already as
generics in *fea2*, this option causes those items in *fea1* to be
copied with unique new names generated by the use of *copy_genhd_uniq*
(3-ESPS). Numerical digits are appended to the generic header item names
in order to render them unique (see *uniq_name* (3-ESPS)).

**-a**  
If the selected fields in *fea1* and all fields in *fea2* have
non-conflicting names, and if both *fea1* and *fea2* have the generic
header items *record_freq* and *start_time* defined, then this option
can be used to merge the files in a time-aligned manner. The output file
*fea3* has the same record frequency *record_freq* as *fea2*, and it
consists of records that correspond to the time intersection of the two
input files. In case that input record frequencies differ, a zero-th
order (or nearest-neighbor) interpolation scheme is performed on records
of *fea1*.

**-x** *debug_level \[0\]*  
If *debug_level* is positive, *mergefea* outputs debugging messages. The
messages proliferate as *debug_level* increases. For level 0, there is
no output.

**-z**  
Suppress the warning that is normally printed if *record_freq* is
defined with different values in the two input files.

**-T** *FEA_subtype \[(same as *fea2*)\]*  
If this option is given, the feature file subtype code in the output
file is filled in with the given code. The symbolic name of the subtype
code must be given, for example FEA_ANA or FEA_SD (or NONE). For a
complete list of defined subtype codes, see FEA(5-ESPS). Use of this
option doesn't ensure that the file has the correct format for the
specified subtype. You should use this option only when you knows that a
file with the correct fields and generic header items will be produced.
See the section 5 manual pages for the defined feature file types.

# ESPS PARAMETERS

No parameter file is used by *mergefea*.

# ESPS COMMON

ESPS Common is not read or written by *mergefea*.

# ESPS HEADERS

The generic header items from both input files are added as generic
header items to the output file. If generic header items with the same
name exist in both input files, the value from *fea2* is used (but see
the **-u** option).

The input files *fea1* and *fea2*, if both exist, are added as source
files in the output header; otherwise only *fea1* is added. The generic
header items *start_time* and *record_freq* are handled like any others.
In addition, if *record_freq* is defined with different values in the
two input files, the program prints a warning. The **-z** option will
suppress the warning.

If *fea2* exists, its FEA subtype code is preserved in the output unless
a different choice is specified with the **-T** option.

# FUTURE CHANGES

Add range processing options.

Add parameter file processing.

# SEE ALSO

*uniq_name* (3-ESPS), *copy_genhd* (3-ESPS),\
*copy_genhd_uniq* (3-ESPS), *copysps* (1-ESPS),\
*fea_deriv* (1-ESPS), *addfea* (1-ESPS),\
*addgen* (1-ESPS) *addfeahd* (1-ESPS), *select* (1-ESPS),\
*feafunc* (1-ESPS), *fea_edit* (1-ESPS)

# WARNINGS AND DIAGNOSTICS

*Mergefea* will exit with an error message if *fea1*, and *fea2* if it
exists, are not ESPS FEA files; if "-" is given for both *fea1* and
*fea2* and *fea3* is given; if *record_freq* is defined with different
values in the two input files; if fields named by a **-f** option do not
exist in *fea1*; or if fields to be merged in from *fea1* already exist
in *fea2*. Note that field names can be changed by using *feafunc*
(1-ESPS) or by running *fea_edit* (1-ESPS) and editing the
self-description.

# BUGS

None known.

# AUTHOR

Manual page by John Shore. Program by Alan Parker, with revisions by
John Shore.
