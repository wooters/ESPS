# NAME

testsd - make test signal (sine wave, square wave, noise, pulses, ASCII
input, etc.)

# SYNOPSIS

**testsd** \[ **-P** *param_file* \] \[ **-x** *debug_level* \] \[
**-T** *signal_type* \] \[ **-f** *frequency* \] \[ **-A** *phase* \] \[
**-l** *level* \] \[ **-C** *sweep_rate* \] \[ **-d** *decay_time* \] \[
**-r** *sampling_rate* \] \[ **-{ps}** *length* \] \[ **-a** *asciifile*
\] \[ **-S** *seed* \] \[ **-t** *data_type* \] \[ **-c** \] \[ **-i**
\] *sdfile*

# DESCRIPTION

*Testsd* produces test sampled data and puts it into the real or
complex, single-channel FEA_SD file *sdfile*. For many of the signal
types, one can specify an exponential amplitude decay and a linear
frequency sweep.

If "-" is supplied in place of *sdfile,* then standard output is used.
The default data type in the output FEA_SD file is FLOAT (or
FLOAT_CPLX). Any output data type can be specified with the **-t**
option (see also **-c** and **-i**).

The following signal types are supported:

Sine waves or complex exponentials (**-T** sine)  
If real sine waves are specified, the output data are *level*\**sin*\[
pi (2fn/r + P/180)\], where "pi" stands for the obvious thing, f is the
frequency, n is the sample number, r is the sampling rate, and P is the
phase (in degrees). Complex exponentials of the form *level*\**exp*\[i
pi (2fn/r + P/180)\] will be generated if the signal type is "sine" and
a complex *data_type* is specified.

Square waves (**-T** square)  
In the terms defined above, the output data are *level*\**square*\[pi
(2fn/r + P/180)\], where *square*() is a function with positive constant
value from 0 to 180 degrees, and negative constant value from 180 to 360
degrees.

Triangular waves (**-T** triangle)  
The output data are *level*\**triangle*\[pi (2fn/r + P/180)\], where
*triangle*() is a piecewise constant function that "approximates" a sine
wave with alternating positive and negative slope segments.

Saw tooth wave (**-T** sawtooth)  
The output data are *level*\**saw*\[pi (fn/r + P/180)\], where *saw*()
is a constant-slope (ramp) function with value zero at 0 degrees and
value one at 360 degrees.

Pulse train (**-T** pulses)  
Positive pulses of amplitude *level* are spaced equally through
*sdfile,* starting at record 1 and with spacing equal to the reciprocal
of the *frequency* (rounded to the closest sample). More precisely, the
output data are zero everywhere except at the sample closest to the
points at which the angle function pi\*(fn/r + P/180) goes through
multiples of 2\*pi.

Constant (**-T** constant)  
A constant value *level* is generated.

Gaussian noise (**-T** gauss)  
Gaussian noise is generated with *level* being the rms value.

Uniform noise (**-T** uniform)  
Uniform noise is generated in the interval \[-*level*, *level*\].

ASCII input data (**-a**)  
Arbitrary data can be provided using the input ASCII file *asciifile.*
(If "-" is supplied in place of *asciifile,* then standard input is
used).

If a complex output data type is specified (see **-t** and **-c**), the
action taken depends on the *signal_type*. For SINE, complex
exponentials are generated (as described above). For the signal types
SQUARE, TRIANGLE, SAWTOOTH, CONSTANT, and PULSES the real and imaginary
parts are identical. For noise types (GAUSS and UNIFORM), independent
noise is generated for the real and imaginary parts. For ASCII input, it
is assumed that the real and imaginary parts alternate in the input,
with the first value being real.

For all signal types but ASCII, a decaying exponential envelope can be
imposed by means of the **-d** option. In this case, each generated
sample is multiplied by *exp*\[- n/rT\], where T is the *decay_time*, n
is the sample number, and r is the sampling rate. (Growing exponentials
can also be generated by means of a negative *decay_time*, but be
careful since no checks are made for overflow.)

For the periodic signal types (SINE, SQUARE, TRIANGLE, SAWTOOTH, and
PULSES), the instantaneous frequency can be swept linearly with time if
the **-C** option is used. That is, the instantaneous frequency
(derivative of the phase) is given by *f + Cn/r*, where f is the initial
frequency (e.g., from the **-f** option), C is the sweep rate, n is the
sample number, and r is the sampling rate. Note that, since the
frequency is modified at every sample (rather than, for example, at the
end of every period), the waveform shapes for TRIANGLE and SAWTOOTH will
be distorted from their usual piecewise-linear shapes. For PULSES, the
point at which the pulse appears is rounded to the nearest sample.

Except for the case of ASCII input data, the output from *testsd* is
buffered, which means that one can generate an extremely long signal
without running out of memory (one might, for example, want to do this
as the input to a pipe). In the case of ASCII data, the output is not
buffered - all the data are input before the output file is generated.
For applications in which this is a problem, one can instead use
*addfea*(1-ESPS), which does buffer the data (it does it one sample at a
time, however, so it will be slower than *testsd* for the same input).
Another advantage of *addfea*, is that one can use it to convert ASCII
data to a multi-channel FEA_SD file. For example, the command


    	%addfea -T FEA_SD -f samples -t float_cplx -s 2 data.ascii data.fea

converts ASCII data to a two-channel, complex FEA_SD file.

# OPTIONS

The following options are supported:

**-P** *param_file \[params\]*  
uses the parameter file *param_file* rather than the default, which is
*params.*

**-x** *debug_level \[0\]*  
If *debug_level* is positive, *testsd* prints debugging messages and
other information on the standard error output. The messages proliferate
as the *debug_level* increases. If *debug_level* is 0, no messages are
printed. Only levels 0 and 1 are supported.

**-T** *signal_type \[sine\]*  
Specifies the signal_type of test data. Possible values are "sine" (for
a sine wave or complex exponential), "square" (for square waves),
"triangle" (for triangle waves), "sawtooth" for sawtooth waves, "pulses"
(for a pulse train), "constant" (for a sequence of constant values),
"gauss" (for Gaussian noise), and "uniform" (for uniform noise). The
**-T** option may not be used if **-a** is specified (for ASCII input).

**-f** *frequency \[500\]*  
Specifies the frequency in the case of periodic signals (sine, square,
triangle, sawtooth, pulses). This option is ignored if **-a** is
specified.

**-A** *phase\[0\]*  
Specifies the phase in the case of all periodic signals (sine, square,
triangle, sawtooth, pulses). The phase is given in units of degrees.

**-l** *level \[500\]*  
Selects the power level of the test data. For Gaussian noise, *level* is
the RMS amplitude (standard deviation). For uniform noise, values are
generated in the interval \[-*level*, *level*\]. For periodic signals
(sine, square, triangle, sawtooth, pulses), *level* is the maximum
amplitude of the waveform. For constant data, all samples have the value
*level*. This option is ignored if **-a** is specified.

**-r** *samp_rate \[8000\]*  
Specifies the sampling rate. The default is 8000 Hz.

**-C** *sweep_rate \[0\]*  
Specifies the linear sweep rate ("linear chirp") for periodic signal
types (sine, square, triangle, sawtooth, and pulses).

**-d** *decay_time \[0\]*  
Specifies the decay time for an optional exponential factor that is
applied to all samples (except ASCII input). The *decay_time* is the
time (in seconds) it takes for the factor to decay to from 1.0 to 1/e.
If a negative number is supplied for *decay_time*, exponential growth
(instead of decay) will result. Note that no checks for overflow are
made in this case (so beware!).

**-p** *length \[8000\]*  
Specifies that *sdfile* contain *length* points. This option is not
allowed if **-a** is specified.

**-s** *length*  
Specifies that *sdfile* contain *length* seconds of sampled data. This
option is not allowed if **-a** is specified.

**-a** *asciifile*  
Specifies that the sampled data is to be taken from the input ASCII file
*asciifile.* Numbers in *asciifile* may be integer or real, with numbers
separated by white space or new lines.

**-S** *seed \[1234567\]*  
Specifies the starting seed for the random number generator (relevant if
Gaussian noise is being generated).

**-t** *data_type \[float\]*  
Specifies the output data type. Possible values are all of the supported
FEA types. In particular, possible values for real types are DOUBLE,
FLOAT, LONG, SHORT, and BYTE, (signed CHAR); possible values for complex
types are DOUBLE_CPLX, FLOAT_CPLX, LONG_CPLX, SHORT_CPLX, and BYTE_CPLX.
The values can be given in upper or lower case as arguments to the
**-t** option. For convenience, a complex output type can be specified
by giving the corresponding real type in the **-t** option and at the
same time specifying the **-c** option.

If a complex output type is specified, the handling of the imaginary
part depends on the signal type. For SINE, complex exponentials are
generated (as described above). For SQUARE, TRIANGLE, SAWTOOTH, PULSES,
and CONSTANT, the real and imaginary parts are identical. For noise
types (GAUSS and UNIFORM), independent noise is generated for the real
and imaginary parts. For ASCII input, it is assumed that the real and
imaginary parts alternate in the input, with the first value being real.

**-c**  
Specifies that a complex FEA_SD file is to be generated. If used
together with the **-a** option, it is assumed that the real and
imaginary parts alternate in the ASCII input. If used in conjunction
with a specified real output type (e.g., **-t** long), the output is set
to the corresponding complex type (e.g., long_cplx). This option is
ignored if a complex type is specified by other means (e.g., **-t**
long_cplx).

**-i**  
Specifies that the data type in *sdfile* is a SHORT (or SHORT_CPLX if
**-c** is used). This option is provided for compatibility with previous
versions (in which FLOAT was the default type), and should be avoided.
If used, it will override other type specifications.

# ESPS PARAMETERS

The parameter file is not required to be present, as there are default
parameter values that apply. The defaults are those mentioned under
OPTIONS. If the parameter file does exist, the following parameters are
read:

> *signal_type - char \**

> A string giving the type of test data as discussed under **-T**. This
> parameter is not read if the **-T** option is used.

> *freq - double*

> The *frequency* as discussed under **-f**. This parameter is read only
> in the case of periodic signals. It is not read if the **-f** option
> is used.

> *phase - double*

> The phase of real sine waves or complex exponentials. This parameter
> is read only in the case of periodic signals. It is not read if the
> **-A** option is used.

> *samp_rate - int*

> The sampling rate. This parameter is not read if the **-r** option is
> used.

> *level - double*

> The *level* as discussed under **-l**. This parameter is not read if
> the **-l** option is used.

> *sweep_rate - double*

> The *sweep_rate* as discussed under **-C**. This is read only for
> periodic signals. It is not read if the **-C** option is used.

> *decay_time - double* The *decay_time* as discussed under **-d**. This
> is read only for periodic signals. It is not read if the **-d** option
> is used.

> *length - int*

> The number of points to generate - the *length* as discussed under
> **-p**. This parameter is not read if the **-p** option is used.

> *seed - int*

> The *seed* as discussed under **-S**. This parameter is only read only
> in the case of noise signals (GAUSS, UNIFORM). It is not read if the
> **-S** option is used.

> *ascii_file - char \**

> The name of the ASCII file containing input data. This parameter is
> read only if *signal_type* is ASCII and the **-a** option is not used.

> *data_type - char \**

> The name of the desired output data type. The parameter is not read if
> the **-t**, **-c**, or **-i** options are is used.

The values of parameters obtained from the parameter file are printed if
the environment variable ESPS_VERBOSE is 3 or greater. The default value
is 3.

# ESPS COMMON

ESPS Common is not read by *testsd.* If Common processing is enabled and
if the output is not to standard output, then *testsd* writes the
following values into ESPS Common:

> 
>
>     filename = sdfile
>     prog = "testsd"
>     start = 1
>     nan = <total number of points generated>

ESPS Common processing may be disabled by setting the environment
variable USE_ESPS_COMMON to "off". The default ESPS Common file is
.espscom in the user's home directory. This may be overridden by setting
the environment variable ESPSCOM to the desired path. User feedback of
Common processing is determined by the environment variable
ESPS_VERBOSE, with 0 causing no feedback and increasing levels causing
increasingly detailed feedback. If ESPS_VERBOSE is not defined, a
default value of 3 is assumed.

# ESPS HEADERS

*Testsd* writes the usual FEA_SD header items. Unless ASCII data is
being converted, "max_value" is set to a maximum possible value (e.g.,
*level* in the case of sine waves), rather than to the actual maximum
(which might be less); note that in the case of complex data types, the
item "max_value" is the complex modulus. If the type is ASCII, then the
actual maximum value is put into the header.

If the type is not ASCII, then *testsd* writes the *level* to the
generic header item "level". *Testsd* also writes the generic header
item "signal_type", which identifies the type of test data (SINE, GAUSS,
PULSES, ASCII, etc. ). If the type is GAUSS or UNIFORM, then *testsd*
writes the random number seed to the generic header item "seed". If the
type is SINE, SQUARE, TRIANGLE, SAWTOOTH, or PULSES, then *testsd*
writes the *frequency* to the generic header item "frequency", and the
*phase* to the item "phase". If a *decay_time* or *sweep_rate* is used,
the value is written to a generic header item of the same name.

# FUTURE CHANGES

Additional types of test data will be generated.

# SEE ALSO

    ESPS(5-ESPS), FEA_SD(5-ESPS), addsd(1-ESPS),
    atoarray(3-ESPSu), feafunc(1-ESPS) gauss(3-ESPSsp)

# WARNINGS AND DIAGNOSTICS

*Testsd* will exit with appropriate messages if **-p** and **-s** are
both used, if **-f** is used with **-T**gauss, if **-a** is used with
**-T,** and if **-a** is used with either **-p** or **-s.**

# BUGS

None known.

# REFERENCES

# AUTHOR

Program and manual page by John Shore
