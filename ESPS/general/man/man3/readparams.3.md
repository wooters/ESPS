# NAME

read_params - read parameters from either an ESPS Parameter or Common
file

# SYNOPSIS

**\#include \<esps/param.h\>**\
extern int debug_level;\
**int**\
**read_params (param_file, flag, check_file)**\
**char \*param_file;**\
**int flag;**\
**char \*check_file;**

# DESCRIPTION

*read_params* reads an ESPS Parameter file *param_file*, processes ESPS
Common, and produces a symbol table. ESPS Parameter files are written in
a C-like language; they are processed by *lex* (see below and \[1\] for
more information).

After the symbol table has been created (by *read_params*), symbol
values can be obtained by calls to *getsym*(3-ESPS). Other information
about the parameters can be obtained from *symtype*(3-ESPS),
*symsize*(3-ESPS), *symlist*(3-ESPS),\
*symdefinite*(3-ESPS), *symchoices*(3-ESPS), *symrange*(3-ESPS), and
*symprompt*(3-ESPS).

If the value of *flag* is **SC_NOCOMMON** then only *param_file* is
processed.

If *param_file* is null, then *read_params* uses the ESPS default
parameter file name "params". If *param_file* is non-NULL, and if
*read_params* is unable to find a corresponding, readable parameter
file, a warning is printed. By default, *read_params* uses
*find_esps_file* (3-ESPS) to search for *param_file* along the path
".:\$ESPS_BASE/lib/params". This default search path can be overridden
by setting the *unix* environment variable ESPS_PARAMS_PATH.

If *flag* is **SC_CHECK_FILE**, if an ESPS Common file exists, and if
Common processing is enabled (see ESPS COMMON, below), then the Common
file is processed if *check_file* matches the value of the *filename*
entry in the Common file or if *check_file* is NULL. If a Common file is
processed, *read_params* compares the last modification time of the ESPS
Common and *param_file*. The parameter values in the younger of the two
files takes precedence. Parameter values not occurring in the ESPS
Common file are read from the ESPS Parameter file. Note that, in the
case of indefinite assignment ("?=" or "=?" used as the assignment
operator in the parameter file), Common processing will still occur for
the assigned default value. If the value from Common takes precedence,
it will be this value that is shown as the default when a runtime prompt
is generated by a call to\
*getsym* (3-ESPS).

The *unix* environment variable ESPS_VERBOSE is used to control the
extent of parameter processing feedback messages issued by
*read_params*. There are three significant settings: 0, 1, and 2. If it
is equal to 0, no feedback is provided. If ESPS_VERBOSE is 1, programs
report the value of any parameters taken from ESPS common. If it is 2 or
greater, programs report the values of parameters taken from ESPS
common, the name of the actual parameter file used (if any), and the
values of parameters taken from the parameter file. If ESPS_VERBOSE is
not set, a value of 2 is assumed. Note that parameter file selection is
affected by ESPS_PARAMS_PATH (as described above).

Regardless of ESPS_VERBOSE, if *debug_level* is non-zero, *read_params*
will warn if a parameter file cannot be found (including the default
"params"), will report the name of any parameter file found, and will
report if ESPS Common is processed,

# PARAMETER FILE FORMAT

Parameter files and common files are written in a C-like language.
Parameters may have six types: integer, real (stored as double precision
values), string, character, array of integer, and array of real.

For each parameter, the parameter file contains the following:

> parameter type

> parameter name

> definite assigned value (operator "=") or indefinite assigned value
> (operator "?=")

> (optional) prompt string

> (optional) parameter limitations (discrete choices or range of values)

If the assigned value for a parameter is indefinite (indicated by the
assignment operator "?=" or "=?"), then the user will be prompted for
the value to be used. The prompt will occur at runtime when the
corresponding *getsym* (3-ESPS) call is made. If the optional prompt
string was supplied in the parameter file, that string will be used as
the prompt; otherwise the parameter name will be used. If the user
enters a RETURN in answer to the prompt, the default value will be used.

If the optional parameter limitations are supplied, they are appended to
the prompt string that is used for indefinite assignments. While they
are not enforced by the\
*getsym* (3-ESPS) routines, the limitations are available to user
programs by means of *symchoices* (3-ESPS) and\

Here is an example of a parameter file:


    int order      ?= 10 : "Model order"; # ask for prompt
    int verbose     = no;
    #preemphasis specification
    int preflg      = yes;
    float pre_num   = { 0.9, -0.5 },   # zeros of preemph filter
          pre_den   = { 0.99, -0.99 }, # poles of preemph filter
          scale     = 0.25;
    # prompt for framelength
    int frmlen     ?= 150: "Length of analysis window";
    # prompt for frame shift - show permitted range
    int nshft      ?= 180: "Distance between frames":[0,360];
    # method for autocorrelation computation; ask for prompt and show 3 choices
    string method   ?= "BURG":"Enter analysis method":{"BURG", "AUTOC", "COVAR"};

A simplified grammar follows. In this grammar, parentheses indicate that
the contents may be repeated zero or more times. Square brackets
indicate that the contents are optional (zero or one repetitions).
Vertical bars indicate "or". CHRVAL, STRVAL, FLOVAL, and INTVAL
represent legal C tokens for characters, strings, real values, and
integers respectively. IDENT represents any legal C variable name, other
than one of the reserved keywords. Case is significant, and all
characters of names are significant (the restriction imposed by LEX,
which builds the lexical analyzer, is about 200 characters). Most C
escape sequences like '\n' are supported in character and string
constants. Character constants like '^b', meaning control-b, are also
supported. However, octal and hexadecimal numbers are not supported.
Multiline strings are not supported.


    file      :==  ( statement )
    statement :== type decl ( ',' decl ) ';'
    type      :== "int" | "float" | "char" | "string" | "char *"
    decl      :== IDENT assop value [prompt] [limits]
    value     :== CHRVAL | STRVAL | FLOVAL | INTVAL | array
    array     :== '{' num ( ',' num ) '}'
    num       :== INTVAL | FLOVAL
    prompt    :== ':' STRVAL
    limits    :== choices | range
    choices   :== ':' strarray
    strarray  :== '{' STRVAL ( ',' STRVAL) '}'
    range     :== ':' '[' min ',' max ']' 
    min       :== num
    max       :== num
    assop     :== '=' | '=' '?' | '?' '='

The following keywords are reserved: int, char, string, float, yes, no,
true, false. The keywords "yes" and "true" are treated as integer
conqstants with value one (the C convention for expressing logical
true); the keywords "no" and "false" are integer constants with value
zero.

The comment convention is different from C. It is the same as for the C
shell. A '#' character indicates that the rest of the line is a comment,
unless it is contained in a character or string constant. This makes it
easier to comment out lines.

Note that it is an error to provide a range for a string parameter, but
it is OK to provide choices for a numeric parameter.

# ESPS COMMON

ESPS Common processing may be disabled by setting the environment
variable USE_ESPS_COMMON to "off". The default ESPS Common file is
.espscom in the user's home directory. This may be overidden by setting
the environment variable ESPSCOM to the desired path. If ESPS_VERBOSE is
set to 1 or greater, *read_params* will report the values of any
parameters take from Common.

Upon successful completion, *read_params* returns 0. If it could not
read the parameter file, -1 is returned. If it could not read the common
file, -2 is returned. If it could not read either then -3 is returned.

# EXAMPLE

    Here is a typical ESPS Parameter file:

    # This line is a comment
    int start = 0: "First point";
    int nan = 1000: "Number of points";
    string decrem = "no";
    float harmonic_mult = -99.0;

    read_params ("params",SC_NOCOMMON,NULL);	/* read default parameter file */
    			/* in this case process only "params" */
    start = getsym_i ("start");		/* read symbol from symbol table */

# DIAGNOSTICS

# BUGS

# FILES

~/.espscom - the default ESPS common file.

# SEE ALSO

*getsym*(3-ESPS), *getsymdef*(3-ESPS), *putsym*(3-ESPS),\
*fputsym*(3-ESPS), *symtype*(3-ESPS), *symsize*(3-ESPS),\
*symlist*(3-ESPS), *symdefinite*(3-ESPS), *symchoices*(3-ESPS),
*symrange*(3-ESPS), *symprompt*(3-ESPS), *symerr_exit* (3-ESPS),
*find_esps_file*(3-ESPS), *espsenv*(1-ESPS)

# REFERENCES

\[1\] ETM-S-86-12:jtb, Parameter Files in the Speech Processing System

# AUTHOR

Joe Buck, Man page by Ajaipal S. Virdy; modifications by Alan Parker and
John Shore
