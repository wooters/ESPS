# NAME

lloyd - generate scalar quantizer using Lloyd's algorithm

# SYNOPSIS

lloyd (data, n, cbk, ncwds, converg, hstrm, final_dist, cbk_dist, pop)\
double data\[\], cbk\[\], converg, final_dist, cbk_dist\[\];\
long n, pop\[\]; unsigned ncwds;\
FILE \*hstrm;

# DESCRIPTION

This routine generates a locally optimal scalar quantizer codebook (
*cbk* ) by using Lloyd's algorithm. It returns the codebook along with
the final distortion ( *final_dist* ) that results from representing the
training data ( *data* ) by the codebook, the number of *data* elements
that were closest to each codebook element ( *pop* ), and the average
distortion ( mean squared error) associated with each codebook element (
*cbk_dist* ). The user inputs an array of training data ( *data* ) and
the number of elements in it ( *n* ), specifies how many codewords (
*ncwds* ) are to be generated to represent the training data, and also a
convergence threshold ( *converg* ).

*lloyd* starts by computing the mean of all the elements in *data* to
form the codebook of length one. Larger codebooks are then generated by
splitting the previous codebook (replacing each codeword by two
codewords, separated by a small number), and going through a process of
improving the codebook until convergence is reached. This process works
as follows:

The squared distance is computed between every element of *data* and
every codeword. Each codeword is then replaced by the mean of all the
elements of *data* for which that codeword is the nearest neighbor. The
mean square error that results when each element of *data* is replaced
by the nearest element in the codebook is computed. The improvement loop
stops when the difference between the old distortion and the new
distortion, divided by the old distortion, becomes less than *converg*.

It is possible for an "empty cell" to appear. This happens when no
element of *data* has a particular codebook element as its nearest
neighbor. Empty cells are handled by splitting the codeword
corresponding to the largest cluster (the codeword with the most
training elements as nearest neighbors); this is a heuristic.

If the argument *hstrm* is non-null, it represents a file descriptor and
history information is written on it.

The output codebook is sorted in increasing order.

# DIAGNOSTICS

If more than 10 empty cells appear a message is written to *stderr* and
the program exits. This should never occur unless *ncwds* is too large
compared to *n*.

# BUGS

None known.

# REFERENCES

Y. Linde, A. Buzo, R.M. Gray, An Algorithm for Vector Quantizer Design
IEEE Transactions on Communications, Vol. COM-28, No. 1, January, 1980

# AUTHOR

Joseph T. Buck, modifications by David K. Burton
